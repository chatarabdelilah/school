using System;

namespace My_First_Store
{
    internal class Program
    {
        static void Main(string[] args)
        {
            Console.Write("Enter your username: ");

            string store_name = "Salaam Shop";
            string user_name = Console.ReadLine();
            string[] item_names = { "The Noble Quran", "The Sealed Nectar", "Sahih Muslim", "Prayer mat", "Prayer bead" };
            int[] item_amounts = {60, 63, 40, 5, 33};
            double[] item_prices = { 9.99, 15.99, 22.99, 21.99, 2.99 };
            string[] item_descriptions = {
                "The Quran is the holy book of Allah, revealed to His Prophet Mohammed ﷺ. This release offers the original Arabic text, additionally it contains the english transliteration to make it accessible for both Arabic and English speakers. Perfect for whoever is looking to deepen himself in religion.",
                "The Sealed Nectar is an outstanding and comprehensive biography of the Prophet Mohammed ﷺ. It provides a detailed, well-researched account of his life. It was awarded first prize by the Muslim World League in a worldwide competition of biographies of the Prophet Mohammed ﷺ held in Mecca in 1979. The title of the book means a reference to verse 25 of Surah 83 of the Quran.",
                "Sahih Muslim is the second hadith collection of the hadith. A hadith is a narration of the Prophet Mohammed's ﷺ sayings.",
                "Sponge padded prayer mat with a masjid, moon and star texture.",
                "Prayer beads made of natural pebbles. These prayer beads have 33 pebbles."
            };
            string[] item_attributes = {
                "Arabic with English transliteration",
                "English",
                "English",
                "Green",
                "Black"
            };
            bool admin = false;
            bool running = true;

            while (running)
            {
                Console.Clear();
                Console.ForegroundColor = ConsoleColor.Green;
                Console.WriteLine($"Welcome {user_name} to {store_name}! We are dedicated to providing high-quality Islamic products that enrich your spiritual journey. Our carefully curated collection includes everything from prayer mats, Qurans, and prayer beads to other essential items designed to support your faith and daily rituals.");
                Console.ForegroundColor = ConsoleColor.Blue;
                Console.ForegroundColor = ConsoleColor.Blue;
                Console.WriteLine(new string('-', 100) + "\nProducts for sale:");

                for (int i = 0; i < item_names.Length; i++)
                {
                    if (item_amounts[i] == 0)
                    {
                        Console.WriteLine($"\nName: {item_names[i]}");
                        Console.Write("Amount: ");
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.WriteLine("Sold out!");
                        Console.ForegroundColor = ConsoleColor.Blue;
                    }
                    else
                    {
                        Console.WriteLine($"\nName: {item_names[i]}\nAmount: {item_amounts[i]}");
                    }
                }

                if (admin)
                {
                    Console.Write(new string('-', 100) + "\n1. View a product\n2. Purchase a product\n3. ");
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.Write("Admin login\n");
                    Console.ForegroundColor = ConsoleColor.Blue;
                    Console.WriteLine("4. Quit\n5. Refill");
                    Console.WriteLine(new string('-', 100));
                    Console.Write("Choose an option and enter its corresponding number.\n\n> ");
                }
                else
                {
                    Console.Write(new string('-', 100) + "\n1. View a product\n2. Purchase a product\n3. ");
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.Write("Admin login\n");
                    Console.ForegroundColor = ConsoleColor.Blue;
                    Console.WriteLine("4. Quit");
                    Console.WriteLine(new string('-', 100));
                    Console.Write("Choose an option and enter its corresponding number.\n\n> ");
                }

                int choice = int.Parse(Console.ReadLine());

                Console.WriteLine(new string('-', 100));

                switch (choice)
                {
                    case 1:
                        ViewProduct(item_names, item_amounts, item_prices, item_descriptions, item_attributes);

                        break;
                    case 2:
                        PurchaseProduct(item_names, item_amounts, item_prices);

                        break;
                    case 3:
                        AdminLogin(ref admin);

                        break;
                    case 4:
                        Quit(ref running);

                        break;
                    case 5:
                        Refill(item_names, item_amounts, ref admin);

                        break;
                    default:
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.Write("Invalid option.");
                        Console.ForegroundColor = ConsoleColor.Blue;
                        Console.ReadKey();
                        Console.Clear();

                        break;
                }
                Console.Clear();
            }

            static void ViewProduct(string[] item_names, int[] item_amounts, double[] item_prices, string[] item_descriptions, string[] item_attributes)
            {
                Console.WriteLine("Which product do you wish to view?");

                for (int i = 0; i < item_names.Length; i++)
                {
                    Console.WriteLine($"\n{i + 1}. {item_names[i]}");
                }

                Console.Write("\n> ");

                int item_choice = int.Parse(Console.ReadLine()) - 1;

                Console.WriteLine(new string('-', 100));

                if (item_choice >= 0 && item_choice < item_names.Length)
                {
                    Console.Clear();

                    if (item_amounts[item_choice] == 0)
                    {
                        Console.Write($"Product: {item_names[item_choice]}\n\nAmount: ");
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.Write("Sold out!");
                        Console.ForegroundColor = ConsoleColor.Blue;
                        Console.WriteLine($"\n\nPrice: {item_prices[item_choice]}\n\nDescription: {item_descriptions[item_choice]}\n\nFormat: {item_attributes[item_choice]}");
                    }
                    else
                    {
                        Console.WriteLine($"Product: {item_names[item_choice]}\n\nAmount: {item_amounts[item_choice]}\n\nPrice: {item_prices[item_choice]}\n\nDescription: {item_descriptions[item_choice]}\n\nFormat: {item_attributes[item_choice]}");
                    }

                    Console.Write(new string('-', 100));
                    Console.ReadKey();
                    Console.Clear();
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.Write("Invalid product choice.");
                    Console.ReadKey();
                    Console.Clear();
                }
            }

            static void PurchaseProduct(string[] item_names, int[] item_amounts, double[] item_prices)
            {
                Console.WriteLine("Which product do you wish to buy?");

                for (int i = 0; i < item_names.Length; i++)
                {
                    Console.WriteLine($"\n{i + 1}. {item_names[i]}");
                }

                Console.Write("\n> ");

                int product_choice = int.Parse(Console.ReadLine()) - 1;

                Console.WriteLine(new string('-', 100));

                if (product_choice >= 0 && product_choice < item_names.Length)
                {
                    Console.Write("How many do you want?\n\n> ");

                    int amount = int.Parse(Console.ReadLine());

                    Console.WriteLine(new string('-', 100));

                    if (amount > 0 && amount <= item_amounts[product_choice])
                    {
                        item_amounts[product_choice] -= amount;

                        double total_price = Math.Round(amount * item_prices[product_choice], 2);
                        double final_price = Math.Round(total_price + (total_price * 21) / 100, 2);

                        Console.ForegroundColor = ConsoleColor.Green;
                        Console.WriteLine($"You have successfully purchased {amount} book(s) of {item_names[product_choice]}!");
                        Console.ResetColor();
                        Console.Write($"{total_price}eu => ");
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.Write($"{final_price}eu");
                        Console.ReadKey();
                        Console.Clear();
                    }
                    else
                    {
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.Write($"You have entered an invalid amount! ({amount})\nOur stock of this product contains no more than {item_amounts[product_choice]}!\nPlease enter a number between 0 and {item_amounts[product_choice] + 1} to buy.");
                        Console.ReadKey();
                        Console.Clear();
                    }
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.Write("Invalid product choice!");
                    Console.ReadKey();
                    Console.Clear();
                }
            }

            static void AdminLogin(ref bool admin)
            {
                Console.Write("Enter the password, if you should be truthful:\n\n> ");

                string password = "bismillah";
                string input = Console.ReadLine();

                Console.WriteLine(new string('-', 100));

                if (input == password)
                {
                    admin = true;

                    Console.ForegroundColor = ConsoleColor.Green;
                    Console.WriteLine("You have entered the correct password and have been granted access to the admin panel!");
                    Console.Write("\nMore features coming soon...");
                    Console.ReadKey();
                    Console.Clear();
                }
                else
                {
                    admin = false;

                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.Write("You have not been truthful and neither have you entered a password correct!");
                    Console.ReadKey();
                    Console.Clear();
                }
            }

            static void Quit(ref bool running)
            {
                running = false;

                Console.Write("May Allah grant you a long life!");
                Console.ReadKey();
                Console.Clear();
                Console.ResetColor();
                Environment.Exit(0);
            }

            static void Refill(string[] item_names, int[] item_amounts, ref bool admin)
            {
                if (admin)
                {
                    for (int i = 0; i < item_names.Length; i++)
                    {
                        if (item_amounts[i] == 0)
                        {
                            Console.Write($"{i + 1}. {item_names[i]} | Amount: ");
                            Console.ForegroundColor = ConsoleColor.Red;
                            Console.WriteLine("Sold out!\n");
                            Console.ForegroundColor = ConsoleColor.Blue;
                        }
                        else
                        {
                            Console.WriteLine($"{i + 1}. {item_names[i]} | Amount: {item_amounts[i]}\n");
                        }
                    }

                    Console.Write("Which product do you want to refill?\n\n> ");

                    int refill_choice = int.Parse(Console.ReadLine()) - 1;

                    Console.WriteLine(new string('-', 100));

                    if (refill_choice >= 0 && refill_choice < item_names.Length)
                    {
                        Console.Write("By how much do you wish to refill?\n\n> ");

                        int refill_amount = int.Parse(Console.ReadLine());
                        
                        Console.WriteLine(new string('-', 100));

                        item_amounts[refill_choice] += refill_amount;

                        Console.ForegroundColor = ConsoleColor.Green;
                        Console.Write($"You have successfully refilled a product's stock!\n\nName: {item_names[refill_choice]} | Amount: {(item_amounts[refill_choice])}");
                        Console.ReadKey();
                        Console.Clear();
                        Console.ForegroundColor = ConsoleColor.Blue;
                    }
                    else
                    {
                        Console.ForegroundColor = ConsoleColor.Red;
                        Console.Write("Invalid product choice.");
                        Console.ReadKey();
                        Console.Clear();
                    }
                }
                else
                {
                    Console.ForegroundColor = ConsoleColor.Red;
                    Console.Write("You are not an admin!");
                    Console.ReadKey();
                    Console.Clear();
                    Console.ResetColor();
                }
            }
        }
    }
}
